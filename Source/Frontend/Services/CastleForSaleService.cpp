/*
    Initial author: Convery (tcn@hedgehogscience.com)
    Started: 14-01-2018
    License: MIT
    Notes:
        Provides implementations for Castle-market services.
*/

#pragma once
#include "../../Stdinclude.hpp"

// Endpoints.
void GetCastlesForSale(Gameserver *Server, std::string Request, std::string Body)
{
    /*
        TODO(Convery):
        Remove the hardcoded response.
    */

    MQEL_json Response = MQEL_json::parse(R"({"Result":{"CastlesForSale":[{"SaleId":1,"CastleInfoSummary":{"DefenderAccountSummary":{"Id":1000,"DisplayName":"Theme A","AvatarId":10,"CastleLevel":1},"CastleType":1,"Level":1,"IsNew":true,"IsCastleAttackable":true,"LastPublishedDate":"2014-07-03T17:34:20Z","CastleThemeId":21,"CastleHeartRank":1},"CastleTitleOasisID":15328,"CastleDescriptionOasisID":15332,"FakePriceOasisID":15336,"CastleIconUrl":"UI_Common_CastleSelection_Preview:A","CanBePurchased":true,"SpawnPlotId":1},{"SaleId":2,"CastleInfoSummary":{"DefenderAccountSummary":{"Id":1001,"DisplayName":"Theme B","AvatarId":10,"CastleLevel":1},"CastleType":1,"Level":1,"IsNew":true,"IsCastleAttackable":true,"LastPublishedDate":"2014-07-03T17:34:20Z","CastleThemeId":22,"CastleHeartRank":1},"CastleTitleOasisID":15329,"CastleDescriptionOasisID":15333,"FakePriceOasisID":15336,"CastleIconUrl":"UI_Common_CastleSelection_Preview:B","CanBePurchased":true,"SpawnPlotId":2},{"SaleId":3,"CastleInfoSummary":{"DefenderAccountSummary":{"Id":1002,"DisplayName":"Theme C","AvatarId":10,"CastleLevel":1},"CastleType":1,"Level":1,"IsNew":true,"IsCastleAttackable":true,"LastPublishedDate":"2014-07-03T17:34:20Z","CastleThemeId":23,"CastleHeartRank":1},"CastleTitleOasisID":15330,"CastleDescriptionOasisID":15334,"FakePriceOasisID":15336,"CastleIconUrl":"UI_Common_CastleSelection_Preview:C","CanBePurchased":true,"SpawnPlotId":3},{"SaleId":4,"CastleInfoSummary":{"DefenderAccountSummary":{"Id":1003,"DisplayName":"Pink Castle","AvatarId":10,"CastleLevel":1},"CastleType":1,"Level":1,"IsNew":true,"IsCastleAttackable":true,"LastPublishedDate":"2014-07-03T17:34:20Z","CastleThemeId":9,"CastleHeartRank":1},"CastleTitleOasisID":15331,"CastleDescriptionOasisID":15335,"FakePriceOasisID":15337,"CastleIconUrl":"UI_Common_CastleSelection_Preview:Firesly","CastleModelIndex":1,"IsInteractive":true}]}})");

    // Patch the base response with our data.

    Sendreply(Server, Response.dump());
}
void GetCastleForSaleBuildInfo(Gameserver *Server, std::string Request, std::string Body)
{
    MQEL_json Response = MQEL_json::parse(R"({"GlobalNotifications":[{"$type":"HyperQuest.GameServer.Contracts.SeasonalCompetitionStartedNotification, HyperQuest.GameServer.Contracts","StartDate":"2016-10-24T00:00:00Z","Id":"580d4f005c98320a9cb0e40f","NotificationType":4}],"Result":{"Draft":{"$type":"HyperQuest.GameServer.Contracts.UbisoftCastle, HyperQuest.GameServer.Contracts","IsForSaleCastle":true,"ForceCastleLevelOnBuildables":true,"AccountId":1003,"AccountDisplayName":"Pink Castle","LayoutId":1,"CreationDate":"2014-03-07T00:07:28Z","ModificationDate":"2014-07-03T17:34:20Z","Rooms":[{"Creatures":[{"RoomZoneId":1,"X":19,"Y":10,"Orientation":3,"Id":55,"SpecContainerId":1077}],"Traps":[{"RoomZoneId":1,"X":16,"Y":29,"Orientation":3,"Id":504,"SpecContainerId":67},{"RoomZoneId":1,"X":22,"Y":29,"Orientation":3,"Id":505,"SpecContainerId":67},{"PowerSupplyCastleBuildableId":505,"RoomZoneId":1,"X":13,"Y":35,"Id":506,"SpecContainerId":1015},{"PowerSupplyCastleBuildableId":504,"RoomZoneId":1,"X":22,"Y":34,"Orientation":2,"Id":507,"SpecContainerId":1015},{"PowerSupplyCastleBuildableId":505,"RoomZoneId":1,"X":13,"Y":33,"Id":508,"SpecContainerId":1015}],"Buildings":[{"Rank":1,"RoomZoneId":12,"X":3,"Y":3,"Orientation":2,"Id":1,"SpecContainerId":1},{"Rank":3,"RoomZoneId":11,"Id":2,"SpecContainerId":3},{"Rank":3,"RoomZoneId":13,"Id":3,"SpecContainerId":4},{"Rank":3,"RoomZoneId":7,"X":3,"Orientation":3,"Id":4,"SpecContainerId":13},{"Rank":3,"RoomZoneId":4,"X":3,"Orientation":3,"Id":6,"SpecContainerId":10},{"Rank":3,"RoomZoneId":6,"X":3,"Y":3,"Orientation":2,"Id":7,"SpecContainerId":8},{"Rank":3,"RoomZoneId":3,"Y":3,"Orientation":1,"Id":8,"SpecContainerId":9}],"X":5,"Y":5,"Id":40,"SpecContainerId":25},{"Creatures":[{"AggroPropagationOffsetX":-0.7993546,"AggroPropagationOffsetZ":4.199974,"RoomZoneId":1,"X":22,"Y":32,"Orientation":2,"Id":98,"SpecContainerId":440},{"AggroPropagationOffsetX":-1.88533,"AggroPropagationOffsetZ":-4.521896,"RoomZoneId":1,"X":13,"Y":33,"Id":103,"SpecContainerId":440},{"AggroPropagationOffsetX":-0.9605103,"AggroPropagationOffsetZ":-4.506786,"RoomZoneId":1,"X":13,"Y":32,"Id":108,"SpecContainerId":440},{"AggroPropagationOffsetX":-1.880539,"AggroPropagationOffsetZ":4.282448,"RoomZoneId":1,"X":22,"Y":33,"Orientation":2,"Id":104,"SpecContainerId":440},{"AggroPropagationOffsetX":2.181244,"AggroPropagationOffsetZ":-4.499131,"RoomZoneId":1,"X":14,"Y":2,"Orientation":3,"Id":136,"SpecContainerId":1004},{"RoomZoneId":1,"X":13,"Y":31,"Id":357,"SpecContainerId":440},{"RoomZoneId":1,"X":22,"Y":31,"Orientation":2,"Id":358,"SpecContainerId":440},{"AggroPropagationOffsetX":1.892274,"AggroPropagationOffsetZ":3.093549,"RoomZoneId":1,"X":13,"Y":30,"Id":107,"SpecContainerId":440},{"AggroPropagationOffsetX":-1.934516,"AggroPropagationOffsetZ":4.403104,"RoomZoneId":1,"X":22,"Y":30,"Orientation":2,"Id":105,"SpecContainerId":440},{"AggroPropagationOffsetX":-2.006975,"AggroPropagationOffsetZ":-4.54755,"RoomZoneId":1,"X":13,"Y":34,"Id":109,"SpecContainerId":440},{"AggroPropagationOffsetX":-1.983501,"AggroPropagationOffsetZ":4.496215,"RoomZoneId":1,"X":22,"Y":34,"Orientation":2,"Id":106,"SpecContainerId":440},{"RoomZoneId":1,"X":21,"Y":9,"Orientation":2,"Id":714,"SpecContainerId":1017},{"RoomZoneId":1,"X":18,"Y":2,"Orientation":3,"Id":715,"SpecContainerId":1004},{"RoomZoneId":1,"X":22,"Y":2,"Orientation":3,"Id":716,"SpecContainerId":1004}],"Traps":[{"PowerSupplyCastleBuildableId":525,"RoomZoneId":1,"X":10,"Y":21,"Orientation":3,"Id":167,"SpecContainerId":1005},{"PowerSupplyCastleBuildableId":525,"RoomZoneId":1,"X":8,"Y":17,"Orientation":3,"Id":168,"SpecContainerId":1005},{"PowerSupplyCastleBuildableId":512,"RoomZoneId":1,"X":10,"Y":11,"Orientation":3,"Id":169,"SpecContainerId":1005},{"PowerSupplyCastleBuildableId":512,"RoomZoneId":1,"X":10,"Y":9,"Orientation":3,"Id":217,"SpecContainerId":1000},{"PowerSupplyCastleBuildableId":526,"RoomZoneId":1,"X":18,"Y":33,"Orientation":3,"Id":368,"SpecContainerId":1000},{"PowerSupplyCastleBuildableId":512,"RoomZoneId":1,"X":8,"Y":6,"Orientation":3,"Id":369,"SpecContainerId":1000},{"RoomZoneId":1,"X":18,"Y":6,"Orientation":3,"Id":512,"SpecContainerId":67},{"RoomZoneId":1,"X":8,"Y":25,"Orientation":3,"Id":525,"SpecContainerId":67}],"Decorations":[{"RoomZoneId":1,"X":21,"Y":6,"Orientation":3,"Id":50,"SpecContainerId":136},{"RoomZoneId":1,"X":21,"Y":7,"Orientation":2,"Id":51,"SpecContainerId":136},{"RoomZoneId":1,"X":20,"Y":10,"Id":52,"SpecContainerId":136},{"RoomZoneId":1,"X":22,"Y":6,"Orientation":2,"Id":121,"SpecContainerId":138,"SkuCode":"15149"},{"RoomZoneId":1,"X":22,"Y":10,"Orientation":3,"Id":122,"SpecContainerId":137,"SkuCode":"15148"},{"RoomZoneId":1,"X":22,"Y":9,"Orientation":2,"Id":123,"SpecContainerId":149,"SkuCode":"15489"}],"X":7,"Y":5,"Id":50,"SpecContainerId":7085},{"Traps":[{"PowerSupplyCastleBuildableId":504,"RoomZoneId":1,"X":16,"Orientation":3,"Id":165,"SpecContainerId":1000},{"PowerSupplyCastleBuildableId":505,"RoomZoneId":1,"X":18,"Orientation":3,"Id":329,"SpecContainerId":1000},{"PowerSupplyCastleBuildableId":512,"RoomZoneId":1,"X":22,"Y":35,"Orientation":2,"Id":164,"SpecContainerId":1002},{"PowerSupplyCastleBuildableId":504,"RoomZoneId":1,"X":22,"Y":1,"Orientation":3,"Id":509,"SpecContainerId":1005},{"PowerSupplyCastleBuildableId":511,"RoomZoneId":1,"X":16,"Y":5,"Orientation":3,"Id":510,"SpecContainerId":1005},{"RoomZoneId":1,"X":22,"Y":13,"Orientation":3,"Id":511,"SpecContainerId":67},{"PowerSupplyCastleBuildableId":511,"RoomZoneId":1,"X":22,"Y":9,"Orientation":3,"Id":513,"SpecContainerId":1005},{"PowerSupplyCastleBuildableId":516,"RoomZoneId":1,"X":16,"Y":14,"Orientation":3,"Id":514,"SpecContainerId":1005},{"PowerSupplyCastleBuildableId":516,"RoomZoneId":1,"X":22,"Y":19,"Orientation":3,"Id":515,"SpecContainerId":1005},{"RoomZoneId":1,"X":16,"Y":19,"Orientation":3,"Id":516,"SpecContainerId":67},{"RoomZoneId":1,"X":18,"Y":30,"Orientation":3,"Id":517,"SpecContainerId":67},{"PowerSupplyCastleBuildableId":517,"RoomZoneId":1,"X":16,"Y":23,"Orientation":3,"Id":518,"SpecContainerId":1005},{"PowerSupplyCastleBuildableId":517,"RoomZoneId":1,"X":22,"Y":27,"Orientation":3,"Id":519,"SpecContainerId":1005},{"PowerSupplyCastleBuildableId":511,"RoomZoneId":1,"X":17,"Y":7,"Orientation":3,"Id":520,"SpecContainerId":1000},{"PowerSupplyCastleBuildableId":511,"RoomZoneId":1,"X":17,"Y":14,"Orientation":3,"Id":521,"SpecContainerId":1000},{"PowerSupplyCastleBuildableId":516,"RoomZoneId":1,"X":18,"Y":21,"Orientation":3,"Id":522,"SpecContainerId":1000},{"PowerSupplyCastleBuildableId":516,"RoomZoneId":1,"X":17,"Y":25,"Orientation":3,"Id":523,"SpecContainerId":1000},{"PowerSupplyCastleBuildableId":517,"RoomZoneId":1,"X":18,"Y":29,"Orientation":3,"Id":524,"SpecContainerId":1000}],"Decorations":[{"RoomZoneId":1,"X":14,"Y":34,"Orientation":3,"Id":74,"SpecContainerId":139},{"RoomZoneId":1,"X":15,"Y":34,"Orientation":1,"Id":75,"SpecContainerId":139},{"RoomZoneId":1,"X":22,"Y":34,"Orientation":3,"Id":76,"SpecContainerId":139},{"RoomZoneId":1,"X":20,"Y":34,"Orientation":3,"Id":77,"SpecContainerId":139}],"X":6,"Y":5,"Id":56,"SpecContainerId":2006},{"Creatures":[{"AggroPropagationOffsetX":0.4310836,"AggroPropagationOffsetZ":0.8949127,"RoomZoneId":1,"X":29,"Y":30,"Orientation":1,"Id":84,"SpecContainerId":1012},{"AggroPropagationOffsetX":3.833536,"AggroPropagationOffsetZ":0.5860186,"RoomZoneId":1,"X":27,"Y":25,"Orientation":1,"Id":687,"SpecContainerId":1003},{"RoomZoneId":1,"X":32,"Y":22,"Orientation":1,"Id":708,"SpecContainerId":1088},{"RoomZoneId":1,"X":30,"Y":22,"Orientation":1,"Id":709,"SpecContainerId":1088},{"RoomZoneId":1,"X":33,"Y":13,"Orientation":3,"Id":710,"SpecContainerId":1088},{"RoomZoneId":1,"X":31,"Y":13,"Orientation":3,"Id":711,"SpecContainerId":1088}],"Traps":[{"PowerSupplyCastleBuildableId":526,"RoomZoneId":1,"X":16,"Y":31,"Orientation":1,"Id":366,"SpecContainerId":1005},{"PowerSupplyCastleBuildableId":526,"RoomZoneId":1,"X":13,"Y":32,"Id":371,"SpecContainerId":1002},{"PowerSupplyCastleBuildableId":530,"RoomZoneId":1,"X":34,"Y":21,"Id":349,"SpecContainerId":1003},{"PowerSupplyCastleBuildableId":530,"RoomZoneId":1,"X":34,"Y":13,"Id":346,"SpecContainerId":1003},{"RoomZoneId":1,"X":12,"Y":30,"Orientation":1,"Id":526,"SpecContainerId":67},{"RoomZoneId":1,"X":25,"Y":19,"Orientation":1,"Id":530,"SpecContainerId":67}],"Decorations":[{"RoomZoneId":1,"X":10,"Y":19,"Orientation":1,"Id":6,"SpecContainerId":140},{"RoomZoneId":1,"X":9,"Y":23,"Orientation":1,"Id":7,"SpecContainerId":141},{"RoomZoneId":1,"X":7,"Y":23,"Orientation":3,"Id":9,"SpecContainerId":141},{"RoomZoneId":1,"X":6,"Y":24,"Orientation":3,"Id":10,"SpecContainerId":141},{"RoomZoneId":1,"X":8,"Y":24,"Orientation":1,"Id":12,"SpecContainerId":141},{"RoomZoneId":1,"X":9,"Y":17,"Orientation":1,"Id":19,"SpecContainerId":141},{"RoomZoneId":1,"X":7,"Y":19,"Orientation":2,"Id":31,"SpecContainerId":141},{"RoomZoneId":1,"X":6,"Y":17,"Orientation":3,"Id":32,"SpecContainerId":141},{"RoomZoneId":1,"X":3,"Y":14,"Id":33,"SpecContainerId":141},{"RoomZoneId":1,"X":4,"Y":15,"Id":34,"SpecContainerId":141},{"RoomZoneId":1,"X":4,"Y":17,"Orientation":3,"Id":35,"SpecContainerId":141},{"RoomZoneId":1,"X":6,"Y":16,"Orientation":1,"Id":36,"SpecContainerId":140},{"RoomZoneId":1,"X":3,"Y":20,"Orientation":1,"Id":37,"SpecContainerId":140},{"RoomZoneId":1,"X":2,"Y":22,"Orientation":3,"Id":38,"SpecContainerId":141},{"RoomZoneId":1,"X":8,"Y":18,"Orientation":1,"Id":40,"SpecContainerId":140},{"RoomZoneId":1,"X":5,"Y":13,"Orientation":1,"Id":41,"SpecContainerId":140},{"RoomZoneId":1,"X":4,"Y":22,"Orientation":1,"Id":42,"SpecContainerId":140},{"RoomZoneId":1,"X":2,"Y":13,"Orientation":1,"Id":120,"SpecContainerId":141}],"X":8,"Y":5,"Orientation":2,"Id":71,"SpecContainerId":7103},{"X":8,"Y":7,"Orientation":3,"Id":73,"SpecContainerId":21},{"Creatures":[{"RoomZoneId":1,"X":15,"Y":20,"Id":81,"SpecContainerId":1003},{"RoomZoneId":1,"X":20,"Y":21,"Orientation":2,"Id":372,"SpecContainerId":1003}],"Traps":[{"PowerSupplyCastleBuildableId":529,"RoomZoneId":1,"X":19,"Y":9,"Id":170,"SpecContainerId":1005},{"PowerSupplyCastleBuildableId":528,"RoomZoneId":1,"X":13,"Y":9,"Id":345,"SpecContainerId":1005},{"PowerSupplyCastleBuildableId":527,"RoomZoneId":1,"X":13,"Y":33,"Id":364,"SpecContainerId":1003},{"PowerSupplyCastleBuildableId":527,"RoomZoneId":1,"X":22,"Y":34,"Orientation":2,"Id":365,"SpecContainerId":1003},{"RoomZoneId":1,"X":16,"Y":23,"Id":527,"SpecContainerId":67},{"RoomZoneId":1,"X":7,"Y":16,"Id":528,"SpecContainerId":67},{"RoomZoneId":1,"X":25,"Y":16,"Id":529,"SpecContainerId":67}],"X":8,"Y":6,"Orientation":3,"Id":74,"SpecContainerId":7099}],"CreatureTiers":[{"SpecContainerId":1},{"SpecContainerId":2},{"SpecContainerId":34},{"SpecContainerId":426},{"SpecContainerId":1077},{"SpecContainerId":440},{"SpecContainerId":435},{"SpecContainerId":438},{"SpecContainerId":36},{"SpecContainerId":41},{"SpecContainerId":462,"Tier":5},{"SpecContainerId":20},{"SpecContainerId":57},{"SpecContainerId":13},{"SpecContainerId":1088},{"SpecContainerId":1017},{"SpecContainerId":1004},{"SpecContainerId":1012,"AutoLevelUp":false},{"SpecContainerId":1003,"AutoLevelUp":false}],"TrapTiers":[{"SpecContainerId":5},{"SpecContainerId":2},{"SpecContainerId":74},{"SpecContainerId":67},{"SpecContainerId":66},{"SpecContainerId":77},{"SpecContainerId":78},{"SpecContainerId":79},{"SpecContainerId":1015},{"SpecContainerId":1005},{"SpecContainerId":1000},{"SpecContainerId":1002,"AutoLevelUp":false},{"SpecContainerId":1003,"AutoLevelUp":false}],"ThemeId":9},"CastleType":1,"Level":1,"CreatureArchetypes":[{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"Tier":5,"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false}],"TrapArchetypes":[{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false},{"AutoLevelUp":false}],"InventoryThemes":[9],"RoomNextIndex":75,"CreatureNextIndex":717,"TrapNextIndex":531,"DecorationNextIndex":124,"TriggerNextIndex":1,"BuildingNextIndex":9}})");

    Sendreply(Server, Response.dump());
}

// Add the services to the gameserver on startup.
namespace {
    struct Startup {
        Startup()
        {
            Mapservice("/CastleForSaleService.hqs/GetCastlesForSale", GetCastlesForSale);
            Mapservice("/CastleForSaleService.hqs/GetCastleForSaleBuildInfo", GetCastleForSaleBuildInfo);
        };
    };
    static Startup Loader{};
}
