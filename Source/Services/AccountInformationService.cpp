/*
    Initial author: Convery (tcn@ayria.se)
    Started: 14-01-2018
    License: MIT
    Notes:
        Provides implementations for AccouhntInformation services.
*/

#pragma once
#include "../Stdinclude.hpp"

// Endpoints.
void GetAccountInformation(Gameserver *Server, std::string Request, std::string Body)
{
    /*
        TODO(Convery):
        Don't return a static response.
    */

    nlohmann::json Response = R"({"Result":{"News":{},"DefendLog":{"OfflinePeriod":{"EndDateTime":"2016-10-16T10:40:52Z"}},"CountryCode":"US","ShopSkuModifiers":[{"SkuCode":"15224","LimitedQuantityNextUnlockCastleLevelRequirement":2,"LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15226","LimitedQuantityNextUnlockCastleLevelRequirement":2,"LimitedQuantityNextUnlockQuantity":5},{"SkuCode":"15221","LimitedQuantityNextUnlockCastleLevelRequirement":3,"LimitedQuantityNextUnlockQuantity":10},{"SkuCode":"13911","LimitedQuantityNextUnlockCastleLevelRequirement":3,"LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15262","LimitedQuantityNextUnlockCastleLevelRequirement":3,"LimitedQuantityNextUnlockQuantity":3},{"SkuCode":"15229","LimitedQuantityNextUnlockCastleLevelRequirement":4,"LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15230","LimitedQuantityNextUnlockCastleLevelRequirement":6,"LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15263","LimitedQuantityNextUnlockCastleLevelRequirement":8,"LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"16070","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"16071","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"16072","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"16073","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"16074","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"16075","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"16076","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"16077","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"16078","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"16079","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"16080","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"16049","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15805","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15810","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"15811","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"15806","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15835","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15807","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15812","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"15808","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15804","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15809","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15813","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15825","LimitedQuantityNextUnlockQuantity":3},{"SkuCode":"15834","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15872","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15974","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15957","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15814","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15892","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"16067","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15815","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15816","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"16068","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15827","LimitedQuantityNextUnlockQuantity":6},{"SkuCode":"15828","LimitedQuantityNextUnlockQuantity":3},{"SkuCode":"15817","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15856","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"16006","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"16055","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"16058","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"15818","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15819","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15855","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"15890","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"16059","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"16060","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"15820","LimitedQuantityNextUnlockQuantity":3},{"SkuCode":"15821","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"15874","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15981","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"16064","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"16057","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"16061","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"15822","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"16010","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15961","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15853","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15984","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"16062","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"16063","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"15823","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"15830","LimitedQuantityNextUnlockQuantity":3},{"SkuCode":"15977","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"16046","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"16065","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"16066","LimitedQuantityNextUnlockQuantity":2},{"SkuCode":"15854","LimitedQuantityNextUnlockQuantity":1},{"SkuCode":"16032","LimitedQuantityNextUnlockQuantity":1}],"ClientSettings":{"ClientTrackingSettings":{"ClientIdleInterval":60,"GameStateTrackingInterval":300,"IdleTimeThresholds":{"None":30,"Build":30,"Attack":30,"AccountCreation":30,"Home":30,"AttackSelection":30,"Replay":600,"StartMenu":30,"Patcher":30,"UplayLinking":30,"StarterCastleSelection":30,"CastleVisit":30},"GlanceViewDurationTriggerInSeconds":5,"EnabledNavigationTrackings":["game:\/\/forge\/open"]},"XmppInfo":{"Username":"3123971","Password":"AkiTXjIk+EqXzFWmFJGbug==","Domain":"mqel-live","Server":"chat.themightyquest.com","Port":80,"Enabled":true,"ConferenceServer":"conference.mqel-live"},"PrimaryShopUrl":"https:\/\/www.themightyquest.com\/%s\/shop?game_token=%s&steamID=%s&steamTicket=%s&embedded=1","PrimaryShopProductPageUrl":"https:\/\/www.themightyquest.com\/%s\/shop\/%s?game_token=%s&steamID=%s&steamTicket=%s&embedded=1","PrimaryShopPremiumPurchaseUrl":"https:\/\/www.themightyquest.com\/%s\/shop\/category\/blings?minimum_blings_quantity=%i&game_token=%s&steam_id=%s&steam_ticket=%s&embedded=1","PrimaryShopBlingsUrl":"https:\/\/www.themightyquest.com\/%s\/shop\/category\/blings?game_token=%s&steamID=%s&steamTicket=%s&embedded=1","PrimaryShopNonBlingsUrl":"https:\/\/www.themightyquest.com\/%s\/shop?game_token=%s&steamID=%s&steamTicket=%s&embedded=1&excluding_category=blings","FriendReferalUrl":"https:\/\/www.themightyquest.com\/%s\/invites\/new?game_token=%s&embedded=1","WelcomePageSmallUrl":"https:\/\/www.themightyquest.com\/%s\/game_welcome_page\/banner?game_token=%s","WelcomePageUrl":"https:\/\/www.themightyquest.com\/%s\/game_welcome_page?game_token=%s","ShowWelcomePage":true,"MaintenanceUrl":"https:\/\/www.themightyquest.com\/%s\/blog"},"TargetedAttackAvailableCount":5,"AccountId":3123971,"Privileges":9,"Wallet":{"InGameCoin":1000},"BuildInfo":{"Draft":{"AccountId":3123971,"LayoutId":1,"CreationDate":"2016-08-27T08:56:06Z","ModificationDate":"2016-08-27T08:56:06Z","ThemeId":2},"InventoryThemes":[2],"RoomNextIndex":1,"CreatureNextIndex":1,"TrapNextIndex":1,"DecorationNextIndex":1,"TriggerNextIndex":1,"BuildingNextIndex":1,"CastleStats":{"MaxConstructionPoints":20,"WinRatio":0.5,"WinRatioDifficulty":2}},"Inventory":{"InventoryTabCount":2},"BuyBack":{},"Stats":{},"UnlockedEmotes":[1,2,3],"AvatarId":10,"ProfanityFiltering":true}})"_json;

    // Patch the base response with our data.
    Response["Result"]["ClientSettings"]["XmppInfo"]["Server"] = "Cake.ayria.se";

    Debugprint(Response.dump(4));
    Sendreply(Server, Response.dump(4));
}

// Add the services to the gameserver on startup.
namespace {
    struct Startup {
        Startup()
        {
            Mapservice("/AccountInformationService.hqs/GetAccountInformation", GetAccountInformation);
        };
    };
    static Startup Loader{};
}
